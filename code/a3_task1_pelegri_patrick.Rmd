---
title: 'Task 1: PCA (PELEGRI)'
author: "Patrick Pelegri-O'Day"
date: "2/13/2022"
output: html_document
  code_folding: hide # fix to correct syntax
---

```{r setup, include=TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(here)
library(ggfortify)
library(patchwork)
```

## Overview
A useful descriptive introductory summary (3 - 4 sentences) that helps the audience understand the data (include a citation as necessary) and what youâ€™ll be exploring

```{r read in data}

# Find NA values and describe my justification for dropping them / how many I'm dropping
env_df <- read_csv(here('data', 'world_env_vars.csv')) %>% 
  drop_na()

head(env_raw_df, 6)

```

```{r create pca object}
env_pca <- env_df %>% 
  select(-Country) %>% # drop country because all variables for pca need to be numeric
  prcomp(scale = TRUE) # scale the variables so they're directly comparable

# rownames(env_pca) <- env_df$Country # I don't think this works for biplot

```

```{r create df using rotated axes from pca}
loadings_df <- data.frame(env_pca$rotation) %>% # take rotation vector from env_pca
  mutate(axis = row.names(.)) 

new_pts_df <- data.frame(env_pca$x) 
```

```{r plot biplot}
ggplot() + 
  geom_point(data = new_pts_df, aes(x = PC1, y = PC2), color = 'blue') +
  geom_segment(data = loadings_df, x = 0, y = 0,
               aes(xend = PC1, yend = PC2, group = axis),
               arrow = arrow(length = unit(0.25, 'cm'))) +
  geom_text(data = loadings_df,
            aes(x = PC1, y = PC2, label = axis),
            vjust = 0, nudge_y = .2) +
  theme_minimal()
```






A brief summary (nicely formatted and professionally written bulletpoints are fine) highlighting some major takeaways from your PCA that can be gleaned from the biplot (and screeplot, if included) 
